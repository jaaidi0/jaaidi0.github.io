/* ================= TRADUCCIONES ================= */
const i18n = {
    es: {
        loader: { text: "INICIALIZANDO BIOSISTEMA..." },
        nav: { home: "INICIO", featured: "DESTACADO", projects: "PROYECTOS", contact: "CONTACTO" },
        hero: {
            title: "Agro-Tech Developer",
            desc: "De la biologÃ­a molecular al cÃ³digo. Transformo datos agrÃ­colas en inteligencia accionable mediante Python, Data Science e IA.",
            btn1: "VER PROYECTO DESTACADO",
            btn2: "GITHUB"
        },
        featured: {
            title: "PROYECTO DESTACADO",
            project_title: "AEMET Dashboard Pro",
            project_subtitle: "Sistema profesional de inteligencia climÃ¡tica en tiempo real",
            project_desc: "Plataforma avanzada que procesa datos de la API de AEMET con tÃ©cnicas de programaciÃ³n concurrente. Optimizado de 130 segundos a 1.14 segundos mediante ThreadPoolExecutor, rate limiting inteligente y cachÃ© multinivel.",
            metric1: "Mejora rendimiento",
            metric2: "Tasa de Ã©xito",
            metric3: "Errores timeout",
            metric4: "Registros/seg",
            optimizations: "Optimizaciones Clave",
            btn_live: "ğŸš€ VER EN VIVO",
            btn_code: "ğŸ’» CÃ“DIGO"
        },
        projects: {
            title: "OTROS PROYECTOS",
            portfolio_title: "Portfolio Interactivo",
            portfolio_desc: "Portfolio personal con efectos avanzados: partÃ­culas con Canvas API, sistema multilingÃ¼e (ES/EN/FR/AR) y animaciones CSS3.",
            agro_title: "Scripts Agro-Tech",
            agro_desc: "AutomatizaciÃ³n para anÃ¡lisis de suelos, predicciÃ³n de cosechas y optimizaciÃ³n de riego basados en datos meteorolÃ³gicos.",
            botanix_desc: "CreaciÃ³n de contenido educativo automatizado sobre biologÃ­a y ciencia con IA generativa. +1K seguidores en TikTok.",
            btn_code: "CÃ“DIGO",
            btn_github: "GITHUB",
            btn_profile: "VER PERFIL"
        },
        contact: {
            title: "Conectemos",
            intro: "Abierto a colaboraciones en agro-tech, data science o proyectos de impacto social.",
            remote: "Disponible para trabajo remoto.",
            email: "ğŸ“§ Email",
            copyright: "Agro-Tech Developer"
        }
    },
    en: {
        loader: { text: "INITIALIZING BIOSYSTEM..." },
        nav: { home: "HOME", featured: "FEATURED", projects: "PROJECTS", contact: "CONTACT" },
        hero: {
            title: "Agro-Tech Developer",
            desc: "From molecular biology to code. I transform agricultural data into actionable intelligence using Python, Data Science and AI.",
            btn1: "VIEW FEATURED PROJECT",
            btn2: "GITHUB"
        },
        featured: {
            title: "FEATURED PROJECT",
            project_title: "AEMET Dashboard Pro",
            project_subtitle: "Professional real-time climate intelligence system",
            project_desc: "Advanced platform that processes AEMET API data with concurrent programming techniques. Optimized from 130 seconds to 1.14 seconds using ThreadPoolExecutor, intelligent rate limiting and multi-level cache.",
            metric1: "Performance boost",
            metric2: "Success rate",
            metric3: "Timeout errors",
            metric4: "Records/sec",
            optimizations: "Key Optimizations",
            btn_live: "ğŸš€ LIVE DEMO",
            btn_code: "ğŸ’» CODE"
        },
        projects: {
            title: "OTHER PROJECTS",
            portfolio_title: "Interactive Portfolio",
            portfolio_desc: "Personal portfolio with advanced effects: particles with Canvas API, multilingual system (ES/EN/FR/AR) and CSS3 animations.",
            agro_title: "Agro-Tech Scripts",
            agro_desc: "Automation for soil analysis, crop prediction and irrigation optimization based on weather data.",
            botanix_desc: "Automated educational content creation about biology and science with generative AI. +1K followers on TikTok.",
            btn_code: "CODE",
            btn_github: "GITHUB",
            btn_profile: "VIEW PROFILE"
        },
        contact: {
            title: "Let's Connect",
            intro: "Open to collaborations in agro-tech, data science or social impact projects.",
            remote: "Available for remote work.",
            email: "ğŸ“§ Email",
            copyright: "Agro-Tech Developer"
        }
    },
    fr: {
        loader: { text: "INITIALISATION DU BIOSYSTÃˆME..." },
        nav: { home: "ACCUEIL", featured: "VEDETTE", projects: "PROJETS", contact: "CONTACT" },
        hero: {
            title: "DÃ©veloppeur Agro-Tech",
            desc: "De la biologie molÃ©culaire au code. Je transforme les donnÃ©es agricoles en intelligence exploitable grÃ¢ce Ã  Python, Data Science et IA.",
            btn1: "VOIR LE PROJET VEDETTE",
            btn2: "GITHUB"
        },
        featured: {
            title: "PROJET VEDETTE",
            project_title: "AEMET Dashboard Pro",
            project_subtitle: "SystÃ¨me professionnel d'intelligence climatique en temps rÃ©el",
            project_desc: "Plateforme avancÃ©e qui traite les donnÃ©es de l'API AEMET avec des techniques de programmation concurrente. OptimisÃ© de 130 secondes Ã  1,14 secondes avec ThreadPoolExecutor, rate limiting intelligent et cache multiniveau.",
            metric1: "AmÃ©lioration perf.",
            metric2: "Taux de succÃ¨s",
            metric3: "Erreurs timeout",
            metric4: "Enregistrements/s",
            optimizations: "Optimisations ClÃ©s",
            btn_live: "ğŸš€ DÃ‰MO EN DIRECT",
            btn_code: "ğŸ’» CODE"
        },
        projects: {
            title: "AUTRES PROJETS",
            portfolio_title: "Portfolio Interactif",
            portfolio_desc: "Portfolio personnel avec effets avancÃ©s: particules avec Canvas API, systÃ¨me multilingue (ES/EN/FR/AR) et animations CSS3.",
            agro_title: "Scripts Agro-Tech",
            agro_desc: "Automatisation pour l'analyse des sols, prÃ©diction des rÃ©coltes et optimisation de l'irrigation basÃ©e sur les donnÃ©es mÃ©tÃ©o.",
            botanix_desc: "CrÃ©ation de contenu Ã©ducatif automatisÃ© sur la biologie et la science avec IA gÃ©nÃ©rative. +1K abonnÃ©s sur TikTok.",
            btn_code: "CODE",
            btn_github: "GITHUB",
            btn_profile: "VOIR PROFIL"
        },
        contact: {
            title: "Connectons-nous",
            intro: "Ouvert aux collaborations en agro-tech, data science ou projets Ã  impact social.",
            remote: "Disponible pour le travail Ã  distance.",
            email: "ğŸ“§ Email",
            copyright: "DÃ©veloppeur Agro-Tech"
        }
    },
    ar: {
        loader: { text: "...ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨ÙŠÙˆÙ„ÙˆØ¬ÙŠ" },
        nav: { home: "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©", featured: "Ù…Ù…ÙŠØ²", projects: "Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹", contact: "Ø§ØªØµÙ„" },
        hero: {
            title: "Ù…Ø·ÙˆØ± ØªÙ‚Ù†ÙŠØ§Øª Ø²Ø±Ø§Ø¹ÙŠØ©",
            desc: "Ù…Ù† Ø§Ù„Ø¨ÙŠÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ø¬Ø²ÙŠØ¦ÙŠØ© Ø¥Ù„Ù‰ Ø§Ù„Ø¨Ø±Ù…Ø¬Ø©. Ø£Ø­ÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ© Ø¥Ù„Ù‰ Ø°ÙƒØ§Ø¡ Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªÙ†ÙÙŠØ° Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Python ÙˆØ¹Ù„Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ.",
            btn1: "Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ù…Ù…ÙŠØ²",
            btn2: "GITHUB"
        },
        featured: {
            title: "Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ù…Ù…ÙŠØ²",
            project_title: "Ù„ÙˆØ­Ø© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª AEMET",
            project_subtitle: "Ù†Ø¸Ø§Ù… Ø§Ø­ØªØ±Ø§ÙÙŠ Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ù…Ù†Ø§Ø®ÙŠ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ",
            project_desc: "Ù…Ù†ØµØ© Ù…ØªÙ‚Ø¯Ù…Ø© ØªØ¹Ø§Ù„Ø¬ Ø¨ÙŠØ§Ù†Ø§Øª API Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù€ AEMET Ø¨ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„Ù…ØªØ²Ø§Ù…Ù†Ø©. Ù…Ø­Ø³Ù‘Ù† Ù…Ù† 130 Ø«Ø§Ù†ÙŠØ© Ø¥Ù„Ù‰ 1.14 Ø«Ø§Ù†ÙŠØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ThreadPoolExecutor ÙˆØªØ­Ø¯ÙŠØ¯ Ù…Ø¹Ø¯Ù„ Ø°ÙƒÙŠ ÙˆØ°Ø§ÙƒØ±Ø© ØªØ®Ø²ÙŠÙ† Ù…Ø¤Ù‚Øª Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª.",
            metric1: "ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡",
            metric2: "Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­",
            metric3: "Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ù…Ù‡Ù„Ø©",
            metric4: "Ø³Ø¬Ù„Ø§Øª/Ø«Ø§Ù†ÙŠØ©",
            optimizations: "Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
            btn_live: "ğŸš€ Ø¹Ø±Ø¶ Ù…Ø¨Ø§Ø´Ø±",
            btn_code: "ğŸ’» Ø§Ù„ÙƒÙˆØ¯"
        },
        projects: {
            title: "Ù…Ø´Ø§Ø±ÙŠØ¹ Ø£Ø®Ø±Ù‰",
            portfolio_title: "Ù…Ø­ÙØ¸Ø© ØªÙØ§Ø¹Ù„ÙŠØ©",
            portfolio_desc: "Ù…Ø­ÙØ¸Ø© Ø´Ø®ØµÙŠØ© Ù…Ø¹ ØªØ£Ø«ÙŠØ±Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©: Ø¬Ø³ÙŠÙ…Ø§Øª Ù…Ø¹ Canvas APIØŒ Ù†Ø¸Ø§Ù… Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ù„ØºØ§Øª ÙˆØ±Ø³ÙˆÙ… Ù…ØªØ­Ø±ÙƒØ© CSS3.",
            agro_title: "Ù†ØµÙˆØµ Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ©",
            agro_desc: "Ø£ØªÙ…ØªØ© Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªØ±Ø¨Ø© ÙˆØªÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø­Ø§ØµÙŠÙ„ ÙˆØªØ­Ø³ÙŠÙ† Ø§Ù„Ø±ÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬ÙˆÙŠØ©.",
            botanix_desc: "Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ ØªØ¹Ù„ÙŠÙ…ÙŠ Ø¢Ù„ÙŠ Ø­ÙˆÙ„ Ø§Ù„Ø¨ÙŠÙˆÙ„ÙˆØ¬ÙŠØ§ ÙˆØ§Ù„Ø¹Ù„ÙˆÙ… Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„ØªÙˆÙ„ÙŠØ¯ÙŠ. +1K Ù…ØªØ§Ø¨Ø¹ Ø¹Ù„Ù‰ TikTok.",
            btn_code: "Ø§Ù„ÙƒÙˆØ¯",
            btn_github: "GITHUB",
            btn_profile: "Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù"
        },
        contact: {
            title: "Ù„Ù†ØªÙˆØ§ØµÙ„",
            intro: "Ù…Ù†ÙØªØ­ Ù„Ù„ØªØ¹Ø§ÙˆÙ† ÙÙŠ Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ© Ø£Ùˆ Ø¹Ù„Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ùˆ Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„ØªØ£Ø«ÙŠØ± Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ.",
            remote: "Ù…ØªØ§Ø­ Ù„Ù„Ø¹Ù…Ù„ Ø¹Ù† Ø¨ÙØ¹Ø¯.",
            email: "ğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ",
            copyright: "Ù…Ø·ÙˆØ± ØªÙ‚Ù†ÙŠØ§Øª Ø²Ø±Ø§Ø¹ÙŠØ©"
        }
    }
};

/* ================= RED NEURONAL (CANVAS) ================= */
const canvas = document.getElementById('neural-bg');
const ctx = canvas.getContext('2d');
let particles = [];

function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}

window.addEventListener('resize', resize);
resize();

class Particle {
    constructor() {
        this.x = Math.random() * canvas.width;
        this.y = Math.random() * canvas.height;
        this.vx = (Math.random() - 0.5) * 0.5;
        this.vy = (Math.random() - 0.5) * 0.5;
        this.size = Math.random() * 2;
    }
    
    update() {
        this.x += this.vx;
        this.y += this.vy;
        
        if (this.x < 0 || this.x > canvas.width) this.vx *= -1;
        if (this.y < 0 || this.y > canvas.height) this.vy *= -1;
    }
    
    draw() {
        ctx.fillStyle = 'rgba(0, 245, 255, 0.6)';
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
    }
}

function initParticles() {
    particles = [];
    const count = window.innerWidth < 768 ? 40 : 80;
    for (let i = 0; i < count; i++) {
        particles.push(new Particle());
    }
}

function animateParticles() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    particles.forEach(p => {
        p.update();
        p.draw();
        
        particles.forEach(p2 => {
            const dx = p.x - p2.x;
            const dy = p.y - p2.y;
            const dist = Math.sqrt(dx * dx + dy * dy);
            
            if (dist < 150) {
                ctx.strokeStyle = `rgba(0, 245, 255, ${0.15 - dist / 1000})`;
                ctx.lineWidth = 0.5;
                ctx.beginPath();
                ctx.moveTo(p.x, p.y);
                ctx.lineTo(p2.x, p2.y);
                ctx.stroke();
            }
        });
    });
    
    requestAnimationFrame(animateParticles);
}

initParticles();
animateParticles();

window.addEventListener('resize', () => { initParticles(); });

/* ================= LÃ“GICA GENERAL ================= */
let menuBtn, navMenu;

document.addEventListener('DOMContentLoaded', () => {
    
    // LOADER ULTRA RÃPIDO
    setTimeout(() => {
        const loader = document.getElementById('loader');
        if(loader) {
            loader.style.opacity = '0';
            setTimeout(() => { loader.style.display = 'none'; }, 800);
        }
    }, 800);

    const savedLang = localStorage.getItem('lang') || 'es';
    setLang(savedLang);
    
    const muteBtn = document.getElementById('muteBtn');
    let muted = localStorage.getItem('muted') === 'true';
    if(muteBtn) {
        muteBtn.textContent = muted ? 'ğŸ”‡' : 'ğŸ”Š';
        muteBtn.addEventListener('click', () => {
            muted = !muted;
            localStorage.setItem('muted', muted);
            muteBtn.textContent = muted ? 'ğŸ”‡' : 'ğŸ”Š';
        });
    }

    menuBtn = document.getElementById('mobile-menu-btn');
    navMenu = document.getElementById('nav-menu');

    if(menuBtn && navMenu) {
        menuBtn.addEventListener('click', () => {
            menuBtn.classList.toggle('active');
            navMenu.classList.toggle('active');
            document.body.style.overflow = navMenu.classList.contains('active') ? 'hidden' : 'auto';
        });
    }
});

/* ================= FUNCIONES GLOBALES ================= */
window.closeMenuAndScroll = function(id) {
    if(!menuBtn) menuBtn = document.getElementById('mobile-menu-btn');
    if(!navMenu) navMenu = document.getElementById('nav-menu');

    if(navMenu && navMenu.classList.contains('active')) {
        menuBtn.classList.remove('active');
        navMenu.classList.remove('active');
        document.body.style.overflow = 'auto';
    }
    scrollToId(id);
}

function setLang(lang) {
    localStorage.setItem('lang', lang);
    document.querySelectorAll('.lang-switch button').forEach(btn => {
        btn.classList.remove('lang-active');
        if (btn.getAttribute('onclick').includes(`'${lang}'`)) {
            btn.classList.add('lang-active');
        }
    });
    
    if (i18n[lang]) {
        document.querySelectorAll('[data-t]').forEach(el => {
            const keys = el.getAttribute('data-t').split('.');
            let text = i18n[lang];
            keys.forEach(k => { if(text) text = text[k]; });
            if (text) el.textContent = text;
        });
        document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
    }
}

function scrollToId(id) {
    const element = document.getElementById(id);
    if (element) {
        element.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
}